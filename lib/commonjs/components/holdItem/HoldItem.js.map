{"version":3,"names":["HoldItemComponent","items","bottom","containerStyles","disableMove","menuAnchorPosition","activateOn","hapticFeedback","actionParams","closeOnTap","children","state","menuProps","safeAreaInsets","useInternal","deviceOrientation","useDeviceOrientation","isActive","useSharedValue","isAnimationStarted","itemRectY","itemRectX","itemRectWidth","itemRectHeight","itemScale","transformValue","transformOrigin","key","useMemo","nanoid","menuHeight","itemsWithSeparator","filter","item","withSeparator","calculateMenuHeight","length","isHold","containerRef","useAnimatedRef","hapticResponse","style","Haptics","selectionAsync","impactAsync","ImpactFeedbackStyle","notificationAsync","NotificationFeedbackType","activateAnimation","ctx","didMeasureLayout","measured","measure","value","pageY","pageX","height","width","position","getTransformOrigin","WINDOW_WIDTH","WINDOW_HEIGHT","calculateTransformValue","isAnchorPointTop","includes","tY","topTransform","styleGuide","spacing","bottomTransform","top","setMenuProps","itemHeight","itemWidth","itemY","itemX","anchorPosition","scaleBack","withTiming","duration","HOLD_ITEM_TRANSFORM_DURATION","onCompletion","isFinised","isListValid","CONTEXT_MENU_STATE","ACTIVE","runOnJS","scaleHold","HOLD_ITEM_SCALE_DOWN_VALUE","HOLD_ITEM_SCALE_DOWN_DURATION","scaleTap","withSequence","canCallActivateFunctions","willActivateWithTap","gestureEvent","useAnimatedGestureHandler","onActive","_","context","onFinish","overlayGestureEvent","END","animatedContainerStyle","useAnimatedStyle","animateOpacity","withDelay","opacity","transform","scale","containerStyle","React","animatedPortalStyle","transformAnimation","withSpring","SPRING_CONFIGURATION","zIndex","left","translateY","portalContainerStyle","styles","holdItem","animatedPortalProps","useAnimatedProps","pointerEvents","useAnimatedReaction","_state","GestureHandler","handlerChildren","PortalOverlay","portalOverlay","HoldItem","memo"],"sources":["HoldItem.tsx"],"sourcesContent":["import React, { memo, useMemo } from \"react\";\r\nimport { ViewProps } from \"react-native\";\r\n\r\n//#region reanimated & gesture handler\r\nimport {\r\n  TapGestureHandler,\r\n  LongPressGestureHandler,\r\n  TapGestureHandlerGestureEvent,\r\n  LongPressGestureHandlerGestureEvent,\r\n} from \"react-native-gesture-handler\";\r\nimport Animated, {\r\n  measure,\r\n  runOnJS,\r\n  useAnimatedGestureHandler,\r\n  useAnimatedProps,\r\n  useAnimatedRef,\r\n  useAnimatedStyle,\r\n  useSharedValue,\r\n  withDelay,\r\n  withTiming,\r\n  withSequence,\r\n  withSpring,\r\n  useAnimatedReaction,\r\n} from \"react-native-reanimated\";\r\n//#endregion\r\n\r\n//#region dependencies\r\nimport { Portal } from \"@gorhom/portal\";\r\nimport { nanoid } from \"nanoid/non-secure\";\r\nimport * as Haptics from \"expo-haptics\";\r\n//#endregion\r\n\r\n//#region utils & types\r\nimport {\r\n  TransformOriginAnchorPosition,\r\n  getTransformOrigin,\r\n  calculateMenuHeight,\r\n} from \"../../utils/calculations\";\r\nimport {\r\n  HOLD_ITEM_TRANSFORM_DURATION,\r\n  HOLD_ITEM_SCALE_DOWN_DURATION,\r\n  HOLD_ITEM_SCALE_DOWN_VALUE,\r\n  SPRING_CONFIGURATION,\r\n  WINDOW_HEIGHT,\r\n  WINDOW_WIDTH,\r\n  CONTEXT_MENU_STATE,\r\n} from \"../../constants\";\r\nimport { useDeviceOrientation } from \"../../hooks\";\r\nimport styles from \"./styles\";\r\n\r\nimport type { HoldItemProps, GestureHandlerProps } from \"./types\";\r\nimport styleGuide from \"../../styleGuide\";\r\nimport { useInternal } from \"../../hooks\";\r\n//#endregion\r\n\r\ntype Context = { didMeasureLayout: boolean };\r\n\r\nconst HoldItemComponent = ({\r\n  items,\r\n  bottom,\r\n  containerStyles,\r\n  disableMove,\r\n  menuAnchorPosition,\r\n  activateOn,\r\n  hapticFeedback,\r\n  actionParams,\r\n  closeOnTap,\r\n  children,\r\n}: HoldItemProps) => {\r\n  //#region hooks\r\n  const { state, menuProps, safeAreaInsets } = useInternal();\r\n  const deviceOrientation = useDeviceOrientation();\r\n  //#endregion\r\n\r\n  //#region variables\r\n  const isActive = useSharedValue(false);\r\n  const isAnimationStarted = useSharedValue(false);\r\n\r\n  const itemRectY = useSharedValue<number>(0);\r\n  const itemRectX = useSharedValue<number>(0);\r\n  const itemRectWidth = useSharedValue<number>(0);\r\n  const itemRectHeight = useSharedValue<number>(0);\r\n  const itemScale = useSharedValue<number>(1);\r\n  const transformValue = useSharedValue<number>(0);\r\n\r\n  const transformOrigin = useSharedValue<TransformOriginAnchorPosition>(\r\n    menuAnchorPosition || \"top-right\"\r\n  );\r\n\r\n  const key = useMemo(() => `hold-item-${nanoid()}`, []);\r\n  const menuHeight = useMemo(() => {\r\n    const itemsWithSeparator = items.filter((item) => item.withSeparator);\r\n    return calculateMenuHeight(items.length, itemsWithSeparator.length);\r\n  }, [items]);\r\n\r\n  const isHold = !activateOn || activateOn === \"hold\";\r\n  //#endregion\r\n\r\n  //#region refs\r\n  const containerRef = useAnimatedRef<Animated.View>();\r\n  //#endregion\r\n\r\n  //#region functions\r\n  const hapticResponse = () => {\r\n    const style = !hapticFeedback ? \"Medium\" : hapticFeedback;\r\n    switch (style) {\r\n      case \"Selection\":\r\n        Haptics.selectionAsync();\r\n        break;\r\n      case \"Light\":\r\n      case \"Medium\":\r\n      case \"Heavy\":\r\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle[style]);\r\n        break;\r\n      case \"Success\":\r\n      case \"Warning\":\r\n      case \"Error\":\r\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType[style]);\r\n        break;\r\n      default:\r\n    }\r\n  };\r\n  //#endregion\r\n\r\n  //#region worklet functions\r\n  const activateAnimation = (ctx: any) => {\r\n    \"worklet\";\r\n    if (!ctx.didMeasureLayout) {\r\n      const measured = measure(containerRef);\r\n\r\n      itemRectY.value = measured.pageY;\r\n      itemRectX.value = measured.pageX;\r\n      itemRectHeight.value = measured.height;\r\n      itemRectWidth.value = measured.width;\r\n\r\n      if (!menuAnchorPosition) {\r\n        const position = getTransformOrigin(\r\n          measured.pageX,\r\n          itemRectWidth.value,\r\n          deviceOrientation === \"portrait\" ? WINDOW_WIDTH : WINDOW_HEIGHT,\r\n          bottom\r\n        );\r\n        transformOrigin.value = position;\r\n      }\r\n    }\r\n  };\r\n\r\n  const calculateTransformValue = () => {\r\n    \"worklet\";\r\n\r\n    const height =\r\n      deviceOrientation === \"portrait\" ? WINDOW_HEIGHT : WINDOW_WIDTH;\r\n\r\n    const isAnchorPointTop = transformOrigin.value.includes(\"top\");\r\n\r\n    let tY = 0;\r\n    if (!disableMove) {\r\n      if (isAnchorPointTop) {\r\n        const topTransform =\r\n          itemRectY.value +\r\n          itemRectHeight.value +\r\n          menuHeight +\r\n          styleGuide.spacing +\r\n          (safeAreaInsets?.bottom || 0);\r\n\r\n        tY = topTransform > height ? height - topTransform : 0;\r\n      } else {\r\n        const bottomTransform =\r\n          itemRectY.value - menuHeight - (safeAreaInsets?.top || 0);\r\n        tY =\r\n          bottomTransform < 0 ? -bottomTransform + styleGuide.spacing * 2 : 0;\r\n      }\r\n    }\r\n    return tY;\r\n  };\r\n\r\n  const setMenuProps = () => {\r\n    \"worklet\";\r\n\r\n    menuProps.value = {\r\n      itemHeight: itemRectHeight.value,\r\n      itemWidth: itemRectWidth.value,\r\n      itemY: itemRectY.value,\r\n      itemX: itemRectX.value,\r\n      anchorPosition: transformOrigin.value,\r\n      menuHeight: menuHeight,\r\n      items,\r\n      transformValue: transformValue.value,\r\n      actionParams: actionParams || {},\r\n    };\r\n  };\r\n\r\n  const scaleBack = () => {\r\n    \"worklet\";\r\n    itemScale.value = withTiming(1, {\r\n      duration: HOLD_ITEM_TRANSFORM_DURATION / 2,\r\n    });\r\n  };\r\n\r\n  const onCompletion = (isFinised?: boolean) => {\r\n    \"worklet\";\r\n    const isListValid = items && items.length > 0;\r\n    if (isFinised && isListValid) {\r\n      state.value = CONTEXT_MENU_STATE.ACTIVE;\r\n      isActive.value = true;\r\n      scaleBack();\r\n      if (hapticFeedback !== \"None\") {\r\n        runOnJS(hapticResponse)();\r\n      }\r\n    }\r\n\r\n    isAnimationStarted.value = false;\r\n\r\n    // TODO: Warn user if item list is empty or not given\r\n  };\r\n\r\n  const scaleHold = () => {\r\n    \"worklet\";\r\n    itemScale.value = withTiming(\r\n      HOLD_ITEM_SCALE_DOWN_VALUE,\r\n      { duration: HOLD_ITEM_SCALE_DOWN_DURATION },\r\n      onCompletion\r\n    );\r\n  };\r\n\r\n  const scaleTap = () => {\r\n    \"worklet\";\r\n    isAnimationStarted.value = true;\r\n\r\n    itemScale.value = withSequence(\r\n      withTiming(HOLD_ITEM_SCALE_DOWN_VALUE, {\r\n        duration: HOLD_ITEM_SCALE_DOWN_DURATION,\r\n      }),\r\n      withTiming(\r\n        1,\r\n        {\r\n          duration: HOLD_ITEM_TRANSFORM_DURATION / 2,\r\n        },\r\n        onCompletion\r\n      )\r\n    );\r\n  };\r\n\r\n  /**\r\n   * When use tap activation (\"tap\") and trying to tap multiple times,\r\n   * scale animation is called again despite it is started. This causes a bug.\r\n   * To prevent this, it is better to check is animation already started.\r\n   */\r\n  const canCallActivateFunctions = () => {\r\n    \"worklet\";\r\n    const willActivateWithTap =\r\n      activateOn === \"double-tap\" || activateOn === \"tap\";\r\n\r\n    return (\r\n      (willActivateWithTap && !isAnimationStarted.value) || !willActivateWithTap\r\n    );\r\n  };\r\n  //#endregion\r\n\r\n  //#region gesture events\r\n  const gestureEvent = useAnimatedGestureHandler<\r\n    LongPressGestureHandlerGestureEvent | TapGestureHandlerGestureEvent,\r\n    Context\r\n  >({\r\n    onActive: (_, context) => {\r\n      if (canCallActivateFunctions()) {\r\n        if (!context.didMeasureLayout) {\r\n          activateAnimation(context);\r\n          transformValue.value = calculateTransformValue();\r\n          setMenuProps();\r\n          context.didMeasureLayout = true;\r\n        }\r\n\r\n        if (!isActive.value) {\r\n          if (isHold) {\r\n            scaleHold();\r\n          } else {\r\n            scaleTap();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    onFinish: (_, context) => {\r\n      context.didMeasureLayout = false;\r\n      if (isHold) {\r\n        scaleBack();\r\n      }\r\n    },\r\n  });\r\n\r\n  const overlayGestureEvent = useAnimatedGestureHandler<\r\n    TapGestureHandlerGestureEvent,\r\n    Context\r\n  >({\r\n    onActive: (_) => {\r\n      if (closeOnTap) state.value = CONTEXT_MENU_STATE.END;\r\n    },\r\n  });\r\n  //#endregion\r\n\r\n  //#region animated styles & props\r\n  const animatedContainerStyle = useAnimatedStyle(() => {\r\n    const animateOpacity = () =>\r\n      withDelay(HOLD_ITEM_TRANSFORM_DURATION, withTiming(1, { duration: 0 }));\r\n\r\n    return {\r\n      opacity: isActive.value ? 0 : animateOpacity(),\r\n      transform: [\r\n        {\r\n          scale: isActive.value\r\n            ? withTiming(1, { duration: HOLD_ITEM_TRANSFORM_DURATION })\r\n            : itemScale.value,\r\n        },\r\n      ],\r\n    };\r\n  });\r\n  const containerStyle = React.useMemo(\r\n    () => [containerStyles, animatedContainerStyle],\r\n    [containerStyles, animatedContainerStyle]\r\n  );\r\n\r\n  const animatedPortalStyle = useAnimatedStyle(() => {\r\n    const animateOpacity = () =>\r\n      withDelay(HOLD_ITEM_TRANSFORM_DURATION, withTiming(0, { duration: 0 }));\r\n\r\n    let tY = calculateTransformValue();\r\n    const transformAnimation = () =>\r\n      disableMove\r\n        ? 0\r\n        : isActive.value\r\n        ? withSpring(tY, SPRING_CONFIGURATION)\r\n        : withTiming(-0.1, { duration: HOLD_ITEM_TRANSFORM_DURATION });\r\n\r\n    return {\r\n      zIndex: 10,\r\n      position: \"absolute\",\r\n      top: itemRectY.value,\r\n      left: itemRectX.value,\r\n      width: itemRectWidth.value,\r\n      height: itemRectHeight.value,\r\n      opacity: isActive.value ? 1 : animateOpacity(),\r\n      transform: [\r\n        {\r\n          translateY: transformAnimation(),\r\n        },\r\n        {\r\n          scale: isActive.value\r\n            ? withTiming(1, { duration: HOLD_ITEM_TRANSFORM_DURATION })\r\n            : itemScale.value,\r\n        },\r\n      ],\r\n    };\r\n  });\r\n  const portalContainerStyle = useMemo(\r\n    () => [styles.holdItem, animatedPortalStyle],\r\n    [animatedPortalStyle]\r\n  );\r\n\r\n  const animatedPortalProps = useAnimatedProps<ViewProps>(() => ({\r\n    pointerEvents: isActive.value ? \"auto\" : \"none\",\r\n  }));\r\n  //#endregion\r\n\r\n  //#region animated effects\r\n  useAnimatedReaction(\r\n    () => state.value,\r\n    (_state) => {\r\n      if (_state === CONTEXT_MENU_STATE.END) {\r\n        isActive.value = false;\r\n      }\r\n    }\r\n  );\r\n  //#endregion\r\n\r\n  //#region components\r\n  const GestureHandler = useMemo(() => {\r\n    switch (activateOn) {\r\n      case \"double-tap\":\r\n        return ({ children: handlerChildren }: GestureHandlerProps) => (\r\n          <TapGestureHandler\r\n            numberOfTaps={2}\r\n            onHandlerStateChange={gestureEvent}\r\n          >\r\n            {handlerChildren}\r\n          </TapGestureHandler>\r\n        );\r\n      case \"tap\":\r\n        return ({ children: handlerChildren }: GestureHandlerProps) => (\r\n          <TapGestureHandler\r\n            numberOfTaps={1}\r\n            onHandlerStateChange={gestureEvent}\r\n          >\r\n            {handlerChildren}\r\n          </TapGestureHandler>\r\n        );\r\n      // default is hold\r\n      default:\r\n        return ({ children: handlerChildren }: GestureHandlerProps) => (\r\n          <LongPressGestureHandler\r\n            minDurationMs={150}\r\n            onHandlerStateChange={gestureEvent}\r\n          >\r\n            {handlerChildren}\r\n          </LongPressGestureHandler>\r\n        );\r\n    }\r\n  }, [activateOn, gestureEvent]);\r\n\r\n  const PortalOverlay = useMemo(() => {\r\n    return () => (\r\n      <TapGestureHandler\r\n        numberOfTaps={1}\r\n        onHandlerStateChange={overlayGestureEvent}\r\n      >\r\n        <Animated.View style={styles.portalOverlay} />\r\n      </TapGestureHandler>\r\n    );\r\n  }, [overlayGestureEvent]);\r\n  //#endregion\r\n\r\n  //#region render\r\n  return (\r\n    <>\r\n      <GestureHandler>\r\n        <Animated.View ref={containerRef} style={containerStyle}>\r\n          {children}\r\n        </Animated.View>\r\n      </GestureHandler>\r\n\r\n      <Portal key={key} name={key}>\r\n        <Animated.View\r\n          key={key}\r\n          style={portalContainerStyle}\r\n          animatedProps={animatedPortalProps}\r\n        >\r\n          <PortalOverlay />\r\n          {children}\r\n        </Animated.View>\r\n      </Portal>\r\n    </>\r\n  );\r\n  //#endregion\r\n};\r\n\r\nconst HoldItem = memo(HoldItemComponent);\r\n\r\nexport default HoldItem;\r\n"],"mappings":"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"}